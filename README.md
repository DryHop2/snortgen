# Snortsmith

![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)


**Snortsmith** is a CLI tool for generating [Snort](https://www.snort.org/) rules quickly, safely, and interactively â€” right from your terminal. 

It supports all core Snort rule fields with input validation, auto-incremented SIDs, and options for advanced content matching. Ideal for security engineers, analysts, or red teamers who want to generate clean, valid rules without memorizing syntax. Snortsmith supports a step-by-step interactive mode, CLI input for single rule generation, and batch rule generation from JSON and csv (soon) files.

---

## Features

- Interactive CLI rule builder with prompts
- Input validation for protocol, IPs, ports, and modifiers
- Supports:
  - `content`, `nocase`, `offset`, `depth`
  - `flags`, `pcre` (Perl-compatible regex)
  - `classtype`, `priority`
  - `metadata` (structured + custom)
  - `reference` (e.g., CVEs or URLs)
- Auto-incrementing SID with file-backed state
- Saves rules to `rules/local.rules` by default
- Optional inline comments
- Configurable output and dry-run preview mode
- Config file support via `.snortsmithrc` or `snortsmith.config.toml`

---

## Getting Started

### With Docker (Recommended)

```bash
git clone https://github.com/DryHop2/snortsmith.git
cd snortsmith
docker-compose build
docker-compose run --rm dev
```

### Local Python

```
pip install -r requirements.txt
python main.py -h
pip install .  # installs the snortsmith CLI
```

## Usage

### Rule generation

Run with interactive prompts

```
snortsmith --interactive
```

Run with CLI flags for non-interactive use

```
snortsmith --proto tcp --src-ip any --dst-ip $HOME_NET --dst-port 80 --content "wget" --msg "Suspicious download"
```

Batch mode (from JSON file)

```
snortsmith --batch path/to/rules.json
```

Dry-run preview mode

```
snortsmith --proto udp --dst-port 53 --content "dns" --dry-run
```
### Programmatic API Usage

You can also use Snortsmith as a Python module:

```
from snortsmith_rulegen import run_batch

run_batch(filepath="rules/example.json", dry_run=True)
```
Or use `run()` or `run_interactive()` for CLI-style behavior and single rule generation.

## Example Rule Output

```
alert tcp any any -> $HOME_NET 80 (
    msg:"Suspicious download";
    content:"wget";
    nocase;
    offset:0;
    depth:60;
    flags:S;
    classtype:policy-violation;
    priority:2;
    metadata:attack_target server, deployment perimeter;
    reference:cve,2021-44228;
    sid:1000001;
    rev:1;
)  # Flagged in logs 2025-03-18
```

## Config File Support

You can create a `snortsmith.config.toml` or `~/.snortsmithrc` file to override defaults globally.

```
default_proto = "udp"
default_dst_port = "53"
default_msg = "Auto-generated by Snortsmith"
default_outfile = "rules/dns.rules"
```

Add a sample file with:

```
cp snortsmith.config.example.toml snortsmith.config.toml
```

## Roadmap

### Completed
- Interactive and batch rule generation
- Auto SID generation and revision tracking
- PCRE, metadata, reference, and TCP flag support
- Rule output with configurable SID and message
- JSON-based batch mode
- CLI argument validation and help docs
- Dry-run mode for rule preview
- Inline comment support (# appended to rule)
- Config file support via TOML
- CSV import for batch rules

### Planned future enhancements:
- Rule deduplication (ignore SID/msg on comparison)
- Unit testing
- Sample batch .json and .csv
- SID reset

### Stetch goals (as time allows or requests come in)
- Advanced Snort options (e.g., HTTP specific options, byte_*, non-payload detection, etc.)
- Rule linter/validator
- Snort rule diffing and comparison
- Interactive UI interface
- Mutli-user/team config management

## Requirements
* Python 3.10+
* Docker (optional, for containerized use)

## License
This project is licensed under the MIT license.